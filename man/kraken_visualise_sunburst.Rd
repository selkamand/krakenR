% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KrakenVisualise.R
\name{kraken_visualise_sunburst}
\alias{kraken_visualise_sunburst}
\title{Visualise Kraken classifications as a sunburst plot}
\usage{
kraken_visualise_sunburst(
  kraken_report_df,
  sample,
  ranks = c("F", "G", "S"),
  ancestor = "Ancestor",
  insidetextorientation = c("horizontal", "radial", "tangential"),
  return_data = FALSE
)
}
\arguments{
\item{kraken_report_df}{A Kraken report data.frame produced by
\code{\link{kraken_reports_parse}} or \code{\link{kraken_report_parse}}.
The data must contain at least the columns \code{SampleID}, \code{Rank},
\code{ScientificName}, \code{TaxonomyID}, \code{Level} and
\code{ReadsCoveredByClade}. The data can be pre-filtered to ranks of
interest but must not be resorted from its original Kraken order.}

\item{sample}{Character vector giving one or more sample IDs (matching the
\code{SampleID} column) to include in the plot.}

\item{ranks}{Character vector of rank codes to include (as stored in the
\code{Rank} column), for example \code{c("F", "G", "S")} for family, genus
and species.}

\item{ancestor}{Character scalar used as the label for the inferred root
ancestor when no parent taxon exists (passed to
\code{\link{kraken_annotate_parents}}). Defaults to \code{"Ancestor"}.}

\item{insidetextorientation}{Text orientation for labels inside the
sunburst sectors. Must be one of \code{"horizontal"}, \code{"radial"} or
\code{"tangential"}. Passed to \code{\link[plotly]{plot_ly}}.}

\item{return_data}{Instead of returning the htmlwidget plot, return the data}
}
\value{
A \code{plotly} object representing the sunburst plot.
}
\description{
Creates an interactive sunburst plot of Kraken classification results for one
or more samples. Each ring represents a taxonomic rank and segment sizes are
proportional to \code{ReadsCoveredByClade}. Parentâ€“child relationships are
inferred using \code{\link{kraken_annotate_parents}}.
}
\examples{
# Read in all kraken reports from a directory into a data.frame
kreport_dir <- system.file(
  package = "krakenR",
  "simulated_data/simulated_kraken_reports_inc_zero_counts/"
)
df_kreports <- kraken_reports_parse(kreport_dir)

# Visualise the first sample as a sunburst at family, genus and species level
first_sample <- unique(df_kreports$SampleID)[1]
kraken_visualise_sunburst(
  df_kreports,
  sample = first_sample,
  ranks = c("F", "G", "S")
)
}
